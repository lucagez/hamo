!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n():"function"==typeof define&&define.amd?define(n):n()}(0,function(){var every=function(e){void 0===e&&(e=[]);for(var n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];for(var r=e.length,t=0;t<r;t++)e[t].apply(e,n)};function validator(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(["oncebefore","before","after","onceafter"].indexOf(e[0])<0)throw new Error("Undefined timing "+e[0]);if(e[1]&&"function"!=typeof e[1])throw new TypeError("Hook must be of type function")}function on(e,n){this.queues[e]=(this.queues[e]||[]).concat([n])}function off(e){this.queues[e]=void 0}function build(){var ref=this.queues,before=ref.before,oncebefore=ref.oncebefore,after=ref.after,onceafter=ref.onceafter,any=oncebefore||before||after||onceafter,body="("+(this.async?"async ":"")+"function handler() {";return oncebefore&&(body+="this.every(this.queues.oncebefore, ...arguments);",body+="this.queues.oncebefore = undefined;"),before&&(body+="this.every(this.queues.before, ...arguments);"),any&&(body+="const result = "+(this.async?"await ":"")+"this.func(...arguments);"),(after||onceafter)&&(body+="Promise.resolve().then(() => {",onceafter&&(body+="this.every(this.queues.onceafter, result, ...arguments);",body+="this.queues.onceafter = undefined;"),after&&(body+="this.every(this.queues.after, result, ...arguments);"),body+="});"),any&&(body+="return result;"),body+="})",body.length>0?eval(body):this.func}function wrap(e){return function(){for(var n=[],o=arguments.length;o--;)n[o]=arguments[o];validator.apply(void 0,n),e.apply(this,n),this.handler=build.apply(this)}}var hamo=function(e,n){if(void 0===n&&(n=!1),"function"!=typeof e)throw new TypeError("Hooked must be of type function");var o={queues:{},func:e,async:n,handler:e,build:build,every:every};return[function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return o.handler.apply(o,e)},wrap(on).bind(o),wrap(off).bind(o)]};module.exports=hamo});
