!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n():"function"==typeof define&&define.amd?define(n):n()}(0,function(){var e=function(e){void 0===e&&(e=[]);for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];for(var r=e.length,o=0;o<r;o++)e[o].apply(e,n)};function n(e,n){this.queues[e]=(this.queues[e]||[]).concat([n])}function t(e){this.queues[e]=void 0}function r(e){return function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];(function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(["oncebefore","before","after","onceafter"].indexOf(e[0])<0)throw new Error("Undefined timing "+e[0]);if(e[1]&&"function"!=typeof e[1])throw new TypeError("Hook must be of type function")}).apply(void 0,n),e.apply(this,n),this.handler=o.apply(this)}}function o(){var e=this.queues,n=e.before,t=e.oncebefore,r=e.after,o=e.onceafter,u=t||n||r||o,f="";return t&&(f+="this.every(this.queues.oncebefore, ...arguments);",f+="this.queues.oncebefore = undefined;"),n&&(f+="this.every(this.queues.before, ...arguments);"),u&&(f+="const result = this.func(...arguments);"),(r||o)&&(f+="Promise.resolve().then(() => {",o&&(f+="this.every(this.queues.onceafter, result, ...arguments);",f+="this.queues.onceafter = undefined;"),r&&(f+="this.every(this.queues.after, result, ...arguments);"),f+="});"),u&&(f+="return result;"),f.length>0?new Function(f):this.func}module.exports=function(u){if("function"!=typeof u)throw new TypeError("Hooked must be of type function");var f={queues:{},func:u,handler:u,build:o,every:e};return[function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return f.handler.apply(f,e)},r(n).bind(f),r(t).bind(f)]}});
